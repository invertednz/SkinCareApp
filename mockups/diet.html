<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diet Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* Larger, brand-aligned checkboxes */
    input[type="checkbox"] {
      width: 22px;
      height: 22px;
      /* Mint CTA color per brand */
      accent-color: #a8edea;
    }

    /* Icon buttons for date navigation */
    .icon-button {
      width: 40px;
      height: 40px;
      border-radius: 9999px; /* full */
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #a8edea, #7acccc);
      /* Subtle shadow for elevation */
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    .icon-button i { color: white; }

    /* Pills for common triggers */
    .pill {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 9999px;
      border: 1px solid #e5e7eb; /* gray-200 */
      font-size: 12px;
      color: #111827; /* gray-900 */
      background: #ffffff;
      cursor: pointer;
      user-select: none;
    }
    .pill-active {
      background: #a8edea; /* mint */
      border-color: #a8edea;
      color: #0f172a; /* slate-900 */
    }

    /* Suggestions dropdown */
    .suggestions {
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 20;
    }
    .suggestions button {
      display: block;
      width: 100%;
      text-align: left;
      padding: 8px 10px;
      font-size: 14px;
    }

    /* Meal selector chips */
    .meal-chip {
      padding: 4px 10px;
      border-radius: 9999px;
      border: 1px solid #e5e7eb;
      font-size: 12px;
      background: #ffffff;
      color: #111827;
    }
    .meal-chip.selected {
      background: #a8edea;
      border-color: #a8edea;
      color: #0f172a;
    }
  </style>
</head>
<body class="bg-gray-900 flex items-center justify-center min-h-screen">
  <div class="mobile-frame">
    <div class="flex flex-col h-full bg-white">
      <!-- Header -->
      <header class="deep-gradient p-4">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <a href="index.html" class="mr-3">
              <i class="fas fa-arrow-left text-white"></i>
            </a>
            <h1 class="text-xl font-semibold text-white">Eating Habits</h1>
          </div>
          <div class="w-8 h-8 rounded-full bg-white flex items-center justify-center">
            <i class="fas fa-history text-accent-color"></i>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <main class="flex-1 overflow-y-auto p-4">
        <div class="mb-6">
          <h2 class="text-lg font-medium mb-3">Track Your Diet</h2>
          <p class="text-sm text-gray-600">Log your meals to identify potential food triggers for your skin condition.</p>
        </div>

        <!-- Today's Date -->
        <div class="card p-4 mb-6">
          <div class="flex justify-between items-center">
            <button id="prev-day" class="icon-button" aria-label="Previous day">
              <i class="fas fa-chevron-left"></i>
            </button>
            <div class="text-center">
              <p class="text-xs text-gray-500" id="date-label">Today</p>
              <p class="text-lg font-medium" id="current-date">Loading date...</p>
            </div>
            <div class="flex items-center space-x-2">
              <button id="next-day" class="icon-button" aria-label="Next day">
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Triggers Pills -->
        <div class="card p-4 mb-4">
          <h3 class="text-md font-medium mb-3">Common Trigger Foods</h3>
          <div id="trigger-pills" class="flex flex-wrap gap-2">
            <button type="button" class="pill" data-trigger="Dairy">Dairy</button>
            <button type="button" class="pill" data-trigger="Gluten">Gluten</button>
            <button type="button" class="pill" data-trigger="Sugar">Sugar</button>
            <button type="button" class="pill" data-trigger="Processed">Processed</button>
            <button type="button" class="pill" data-trigger="High-Fat">High-Fat</button>
            <button type="button" class="pill" data-trigger="Spicy">Spicy</button>
            <button type="button" class="pill" data-trigger="Alcohol">Alcohol</button>
            <button type="button" class="pill" data-trigger="Caffeine">Caffeine</button>
            <button type="button" class="pill" data-trigger="Fried">Fried</button>
            <button type="button" class="pill" data-trigger="Citrus">Citrus</button>
          </div>
        </div>

        <!-- Entry with Suggestions and Add Button -->
        <div class="card p-4 mb-6">
          <h3 class="text-md font-medium mb-3">Add What You Ate</h3>
          <div class="flex items-start gap-3">
            <div class="relative flex-1">
              <input id="food-input" type="text" class="w-full p-2 border border-gray-200 rounded-lg" placeholder="e.g., Oatmeal with berries, Chicken salad, Latte" autocomplete="off">
              <div id="suggestions" class="suggestions hidden"></div>
            </div>
            <div class="flex flex-col gap-2">
              <button id="add-food" class="px-3 py-2 rounded-lg text-sm font-medium border border-gray-200" style="background:#a8edea;">Add</button>
            </div>
          </div>
          <div id="food-list" class="mt-4 space-y-2"></div>
        </div>

        <!-- Water Intake -->
        <div class="mb-6 border-t border-gray-100 pt-4">
          <div class="flex items-center mb-3">
            <div class="w-8 h-8 rounded-full secondary-gradient flex items-center justify-center mr-3">
              <i class="fas fa-tint text-white text-xs"></i>
                <h4 class="text-sm font-medium">Water Intake</h4>
              </div>
              
              <div class="mb-3">
                <label class="block text-sm text-gray-600 mb-2">How many glasses of water did you drink today?</label>
                <div class="relative">
                  <input type="range" min="0" max="10" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                  <div class="flex justify-between text-xs text-gray-500 mt-1">
                    <span>0</span>
                    <span>2</span>
                    <span>4</span>
                    <span>6</span>
                    <span>8</span>
                    <span>10</span>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </main>

      <!-- Navigation -->
      <nav class="bg-white border-t border-gray-200 flex justify-around py-2">
        <a href="index.html" class="nav-item">
          <i class="fas fa-home text-lg"></i>
          <span class="text-xs mt-1">Home</span>
        </a>
        <a href="skin-health.html" class="nav-item">
          <i class="fas fa-chart-line text-lg"></i>
          <span class="text-xs mt-1">Track</span>
        </a>
        <a href="chat.html" class="nav-item">
          <i class="fas fa-comment-alt text-lg"></i>
          <span class="text-xs mt-1">Chat</span>
        </a>
        <a href="#" class="nav-item">
          <i class="fas fa-cog text-lg"></i>
          <span class="text-xs mt-1">Settings</span>
        </a>
      </nav>
    </div>
  </div>

  <script>
    // Date navigation and rendering
    const dateElement = document.getElementById('current-date');
    const labelElement = document.getElementById('date-label');
    const btnPrev = document.getElementById('prev-day');
    const btnNext = document.getElementById('next-day');

    const today = new Date();
    function startOfDay(d) { return new Date(d.getFullYear(), d.getMonth(), d.getDate()); }
    let current = startOfDay(today);

    // Trigger pills toggle
    const triggerContainer = document.getElementById('trigger-pills');
    triggerContainer.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-trigger]');
      if (!btn) return;
      btn.classList.toggle('pill-active');
    });

    // Suggestions and input handling
    const foodInput = document.getElementById('food-input');
    const suggestionsEl = document.getElementById('suggestions');
    const addBtn = document.getElementById('add-food');
    const foodList = document.getElementById('food-list');

    const suggestionItems = [
      'Oatmeal', 'Greek yogurt', 'Scrambled eggs', 'Avocado toast', 'Smoothie',
      'Chicken salad', 'Grilled chicken', 'Turkey sandwich', 'Sushi', 'Poke bowl',
      'Pasta', 'Stir fry', 'Salmon', 'Steak', 'Veggie curry',
      'Apple', 'Banana', 'Protein bar', 'Nuts', 'Dark chocolate',
      'Latte', 'Coffee', 'Tea', 'Soda', 'Juice'
    ];

    function showSuggestions(list) {
      if (!list.length) { suggestionsEl.classList.add('hidden'); suggestionsEl.innerHTML = ''; return; }
      suggestionsEl.innerHTML = list.map(item => `<button type="button" data-suggestion="${item}">${item}</button>`).join('');
      suggestionsEl.classList.remove('hidden');
    }
    function hideSuggestions() { suggestionsEl.classList.add('hidden'); suggestionsEl.innerHTML = ''; }

    foodInput.addEventListener('input', () => {
      const q = foodInput.value.trim().toLowerCase();
      if (!q) { hideSuggestions(); return; }
      const filtered = suggestionItems.filter(s => s.toLowerCase().includes(q)).slice(0, 8);
      showSuggestions(filtered);
    });
    suggestionsEl.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-suggestion]');
      if (!btn) return;
      foodInput.value = btn.getAttribute('data-suggestion');
      hideSuggestions();
      foodInput.focus();
    });
    document.addEventListener('click', (e) => {
      if (!suggestionsEl.contains(e.target) && e.target !== foodInput) hideSuggestions();
    });

    // Entries per day: [{ text, meal: 'breakfast'|'lunch'|'dinner'|'snack'|null }]
    const entriesByDate = {};
    function dateKey(d) {
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2, '0');
      const da = String(d.getDate()).padStart(2, '0');
      return `${y}-${m}-${da}`;
    }
    function ensureDayState(key) { if (!entriesByDate[key]) entriesByDate[key] = []; return entriesByDate[key]; }

    function renderList() {
      const items = ensureDayState(dateKey(current));
      if (!items.length) { foodList.innerHTML = '<p class="text-sm text-gray-500">No items yet. Add something above.</p>'; return; }
      foodList.innerHTML = items.map((item, idx) => {
        const chip = (meal, label) => `<button class=\"meal-chip${item.meal===meal?' selected':''}\" data-idx=\"${idx}\" data-set-meal=\"${meal}\">${label}</button>`;
        const title = item.text.replace(/"/g, '&quot;');
        return `
          <div class=\"border border-gray-100 rounded-lg p-2\">\n            <div class=\"flex items-center justify-between gap-3\">\n              <div class=\"flex-1 truncate text-sm\" title=\"${title}\">${item.text}</div>\n              <div class=\"flex items-center gap-2 flex-none\">\n                <button class=\"pill\" aria-label=\"Expand\"><i class=\"fas fa-angle-down\"></i></button>\n                <button class=\"pill\" data-remove=\"${idx}\" aria-label=\"Remove\"><i class=\"fas fa-times\"></i></button>\n              </div>\n            </div>\n            <div class=\"mt-2 -mx-2 px-2 overflow-x-auto\">\n              <div class=\"flex gap-2 pb-1\" style=\"min-width:max-content;\">\n                ${chip('breakfast','Breakfast')}\n                ${chip('lunch','Lunch')}\n                ${chip('dinner','Dinner')}\n                ${chip('snack','Snack')}\n              </div>\n            </div>\n          </div>`;
      }).join('');
    }

    foodList.addEventListener('click', (e) => {
      const setBtn = e.target.closest('[data-set-meal]');
      if (setBtn) {
        const idx = Number(setBtn.getAttribute('data-idx'));
        const meal = setBtn.getAttribute('data-set-meal');
        const items = ensureDayState(dateKey(current));
        if (items[idx]) { items[idx].meal = meal; renderList(); }
        return;
      }
      const removeBtn = e.target.closest('[data-remove]');
      if (removeBtn) {
        const idx = Number(removeBtn.getAttribute('data-remove'));
        const items = ensureDayState(dateKey(current));
        items.splice(idx, 1);
        renderList();
      }
    });

    function addEntry(text) {
      const t = text.trim();
      if (!t) return;
      const items = ensureDayState(dateKey(current));
      items.push({ text: t, meal: null });
      renderList();
    }

    addBtn.addEventListener('click', () => {
      addEntry(foodInput.value);
      foodInput.value = '';
      hideSuggestions();
      foodInput.focus();
    });
    foodInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        addEntry(foodInput.value);
        foodInput.value = '';
        hideSuggestions();
      }
    });

    function renderDate() {
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      dateElement.textContent = current.toLocaleDateString('en-US', options);
      const isToday = startOfDay(current).getTime() === startOfDay(today).getTime();
      labelElement.textContent = isToday ? 'Today' : current.toLocaleDateString('en-US', { weekday: 'long' });
      renderList();
    }
    btnPrev.addEventListener('click', () => { current = new Date(current); current.setDate(current.getDate() - 1); renderDate(); });
    btnNext.addEventListener('click', () => { current = new Date(current); current.setDate(current.getDate() + 1); renderDate(); });

    // Initial render
    renderDate();
  </script>
</body>
</html>